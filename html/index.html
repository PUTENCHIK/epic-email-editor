<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>EmailWizard</title>
	<link rel="stylesheet" href="../css/style.css">
	<link rel="stylesheet" href="../css/letter-settings.css">

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

	<!-- <script src="https://unpkg.com/react@18/umd/react.development.js"></script>			
	<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>		 -->
</head>

<body style="margin: 0; padding: 0;">
	<input id="mainInputText" autofocus type="text" class="mainInputText dissable">
	<div class="page-header">
		<div class="letter-name">
			ProjectName
		</div>
		<div class="header-content">
			<div class="header-elements-group">
				<div class="logo-box">
					<img src="../img/emailwizard-logo.png" alt="logo"/>
				</div>
				<div class="button button-icon button-save" title="Сохранить">
					<img src="../img/save-icon.png" alt="save"/>
				</div>
				<div class="modal-save dissable">
					<p class = "phrase">Вы действительно хотите сохранить это письмо?</p>
					<div class="btns">
						<button id="save-no-btn" class="save-no-btn">Нет</button>
						<button id="save-yes-btn" class="save-yes-btn">Да</button>
					</div>
				</div>
				<div class="button button-text button-myemails">
					<div class="__text">Мои письма</div>
				</div>
			</div>
			<div class="header-elements-group">
				<div class="button button-text primary-button button-send">
					<div class="__text">Отправить</div>
				</div>
				<div class="fixed-window window-send-email dissable">
					<h2>Отправка письма</h2>
					<label>
						<span>Введите почту получателя:</span>
						<input class="form-text" type="email" name="receiver" placeholder="example@outlook.ru">
					</label>
					<label>
						<span>Введите тему письма:</span>
						<input class="form-text" type="text" name="theme" placeholder="Приглашение на конференцию">
					</label>
					<div class="buttons-group">
						<div class="button button-text button-cancel-send">
							<div class="__text">Отмена</div>
						</div>
						<div class="button button-text primary-button button-true-send">
							<div class="__text">Отправить</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<main>
		<div class="leftBlock">
			<div id="templatesBlock" class="templatesBlock">
				<div id="templatesBlockBuff" class="templatesBlockBuff"></div>
				<div id="changeTemplatesBlock"></div>
			</div>
			<div class="choseMenu dissable" id="choseMenu"></div>
		</div>

		<div class="workboard">
			<div id="letter" class="letter">
				<div style="font-size:0px;font-color:#ffffff;opacity:0;visibility:hidden;width:0;height:0;display:none;">Тестовое письмо</div>
				<table cellpadding="0" cellspacing="0" width="100%" bgcolor="#FFFFFF">
					<tr>
						<td>
							<table id="mainTable" class="mainTable table-600" cellpadding="0" cellspacing="0" width="600" align="center">
								<tr class="header" id="header"></tr>
								<tr class="main" id="main"></tr>
								<tr class="footer" id="footer"></tr>
							</table>
						</td>
					</tr> 	 	
				</table>
			</div>
		</div>

		<div id="settings" class="settings">
			<div class="updatetitleBlock">
				<span class="updateTitle">Дизайн</span>
			</div>
			<div id="updateTextBlock" class="updateTextBlock dissable">
				<div class="updateTextFonts">
					<h5 class="updateTextFontsTitle">Тест</h5>
					<div class="fontFamilyBlock">
						<span class="fontFamilyTitle">Шрифт:</span>
						<select class="fontFamilyInput" name="fontFamilyInput" id="fontFamilyInput">
							<option value='"Times New Roman", Times, serif'>'Times New Roman', Times, serif</option>
							<option value="Georgia, serif">Georgia, serif</option>
							<option value="Arial, Helvetica, sans-serif">Arial, Helvetica, sans-serif</option>
							<option value='"Arial Black", Gadget, sans-serif'>'Arial Black', Gadget, sans-serif</option>
							<option value="Verdana, Geneva, sans-serif">Verdana, Geneva, sans-serif</option>
							<option value='"Trebuchet MS", Helvetica, sans-serif'>'Trebuchet MS', Helvetica, sans-serif</option>
							<option value="Impact, Charcoal, sans-serif">Impact, Charcoal, sans-serif</option>
							<option value='"Comic Sans MS", cursive, sans-serif'>'Comic Sans MS', cursive, sans-serif</option>
							<option value='"Courier New", Courier, monospace'>'Courier New', Courier, monospace</option>
						</select>
					</div>
					<div class="fontWeightBlock">
						<span class="fontWeightTitle">Вид шрифта</span>
						<div class="fontWeights">
							<div class="fontWeightBoldBlock">
								<span class="fontWeightBoldSpan"><b>Ж</b></span>
								<input type="checkbox" name="fontWeightBold" id="fontWeightBold">
							</div>
							<div class="fontWeightItalicBlock">
								<span class="fontWeightItalicSpan">К</span>
								<input type="checkbox" name="fontWeightItalic" id="fontWeightItalic">
							</div>
							<div class="fontWeightLinedBlock">
								<span class="fontWeightLinedSpan">Ч</span>
								<input type="checkbox" name="fontWeightLined" id="fontWeightLined">
							</div>
						</div>
						<!-- <input class="fontWeightInput" type="text" name="fontWeightInput" id="fontWeightInput"> -->
					</div>
					<div class="fontSizeBlock">
						<span class="fontSizeTitle">Размер шрифта</span>
						<input class="fontSizeInput" type="text" name="fontSizeInput" id="fontSizeInput">
					</div>
					<div class="lineHeightBlock">
						<span class="lineHeightTitle">Высота строки:</span>
						<input class="lineHeightInput" type="text" name="lineHeightInput" id="lineHeightInput">
					</div>
					<div class="letterSpacingBlock">
						<span class="letterSpacingTitle">Строчное расстояние:</span>
						<input class="letterSpacingInput" type="text" name="letterSpacingInput" id="letterSpacingInput">
					</div>
				</div>
				<div class="updateTextColorBlock">
					<h5 class="updateTextColorTitle">Заливка</h5>
					<div class="updateFillBlock">
						<input id="updateTextColor" class="updateTextColor" type="color">
						<input id="updateTextColorTag" class="updateTextColorTag" type="text" value="#ff0000">
						<input id="updateTextOpacityInput" class="updateTextOpacityInput" type="text">
					</div>
				</div>
				<div class="updatetextAlignmentBlock">
					<h5 class="updatetextAlignmentTitle">Выравнивание</h5>
					<div class="alignments">
						<input type="radio" name="textAlignment" id="textAlignmentLeft" value="left">
						<label for="textAlignmentLeft" class="textAlignmentLeftBlock">
						<span class="textAlignmentLeftSpan">L</span>
						</label>
						
						<input type="radio" name="textAlignment" id="textAlignmentCenter" value="center">
						<label for="textAlignmentCenter" class="textAlignmentCenterBlock">
						<span class="textAlignmentCenterSpan">C</span>
						</label>
						
						<input type="radio" name="textAlignment" id="textAlignmentRight" value="right">
						<label for="textAlignmentRight" class="textAlignmentRightBlock">
						<span class="textAlignmentRightSpan">R</span>
						</label>
					</div>
			   </div>
			</div>
			<div id="updateBackgroundColorBlock" class="updateBackgroundColorBlock dissable">
				<h5 class="updateTextColorTitle">Заливка</h5>
				<div class="updateFillBlock">
					<input id="updateBackgroundColor" class="updateBackgroundColor" type="color">
					<input id="updateBackgroundColorTag" class="updateBackgroundColorTag" type="text" value="#ff0000">
				</div>
			</div>
			<div id="updateImageBlock" class="updateImageBlock dissable">
					<div class="changeImage">
						<div class="displayImageBlock">
							<!-- <input class="updateImageInput" type="file" id="updateImageInput"> -->
							<img class="displayImage" id="displayImage" alt="Bad URL">
						</div>
						<div class="putImageBlock">
							<span class="displayImageText">Поменять фото:</span>
							<input id="path" class="putImage" type="text">
						</div>
					</div>
					<div class="changeImageOpacity">
						<h5 class="updateImageColorTitle">Прозрачность</h5>
						<div class="settingsImageOpacityBlock">
						    <img class="displayImageOpacity" id="displayImageOpacity" alt="">
							<input id="updateImageOpacityInput" class="updateImageOpacityInput" type="text">
						</div>
					</div>
					<div class="updateImageAlignmentBlock">
						<h5 class="updateImageAlignmentTitle">Выравнивание</h5>
						<label for="updateImagePaddingLeftInput" class="updateImagePaddingLeftLabel">Отступ слева:</label>
						<input id="updateImagePaddingLeftInput" class="updateImageWidthInput" type="text">
						<br>
						<label for="updateImagePaddingRightInput" class="updateImagePaddingRightLabel">Отступ справа:</label>
						<input id="updateImagePaddingRightInput" class="updateImageHeightInput" type="text">
				   </div>
				   <div class="updateImageSize">
					<h5 class="updateImageSizeTitle">Image size</h5>
					<div class="settingsImageSizeBlock">
						<label for="updateImageWidthInput" class="updateImagePaddingLeftLabel">Ширина:</label>
						<input id="updateImageWidthInput" class="updateImageWidthInput" type="text">
						<br>
						<label for="updateImageHeightInput" class="updateImagePaddingLeftLabel">Высота:</label>
						<input id="updateImageHeightInput" class="updateImageHeightInput" type="text">
					</div>
				</div>
			</div>
		</div>
	</main>
	
	<script type="text/babel">
		function Header1() {
			return (
				<table className="template header1" cellpadding={"0"} cellspacing={"0"} width={"600"} bgcolor={"#FFFFFF"} align={"center"}>
					<tr>
						<td align={"center"} height={"75px"} bgcolor={"#333333"}>
							<img align={"center"} src={"../img/logoFashion.png"} style={{width: "160px"}}/>
						</td>
					</tr>
					<tr>
						<td align={"center"} style={{paddingTop: "20px", paddingBottom: "20px"}} bgcolor={"#FFFFFF"}>
							<table cellpadding={"0"} cellspacing={"0"} width={"550"} bgcolor={"#FFFFFF"} align={"center"}>
								<tr align={"center"}>
									<td className="menu">
										<a href="#"><span style={{fontSize: "20px", fontFamily: "Arial, Helvetica, sans-serif"}}>Home</span></a>
									</td>
									<td className="menu">
										<a href="#"><span style={{fontSize: "20px", fontFamily: "Arial, Helvetica, sans-serif"}}>Women</span></a>
									</td>
									<td className="menu">
										<a href="#"><span style={{fontSize: "20px", fontFamily: "Arial, Helvetica, sans-serif"}}>Men</span></a>
									</td>
									<td className="menu">
										<a href="#"><span style={{fontSize: "20px", fontFamily: "Arial, Helvetica, sans-serif"}}>Sale</span></a>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			)
		}

		function Header2() {
			return (
					<table className="template header2" cellpadding={"0"} cellspacing={"0"} width={"600"} bgcolor={"#FFFFFF"} align={"center"}>
						<tr>
							<td bgcolor="white" class="header-td">
								<table class="table-550" cellpadding="0" cellspacing="0" width="550" bgcolor="white" align="center">
									<tr>
										<td>
											<table align="left" class="menu leftMenu" cellpadding="0" cellspacing="0">
												<tr>
													<td><a href="#">Menu</a></td>
													<td><a href="#">Reservation</a></td>
												</tr>
											</table>
										</td>
										<td align="center">
											<img style={{width: "150px"}} src="../img/logo.png" alt="logo"/>
										</td>
										<td>
											<table align="center" class="menu rightMenu" cellpadding="0" cellspacing="0">
												<tr>
													<td><a href="#">Events</a></td>
													<td><a href="#">Contact</a></td>
												</tr>
											</table>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
			)
		}

		function Main1() {
			return (
					<table className="template main1" cellpadding={"0"} cellspacing={"0"} width={"600"} bgcolor={"#FFFFFF"} align={"center"}>
						<tr>
							<td class="banner-td">
								<a href="#">
									<img style={{width: "600px"}} src="../img/welcome.jpg" alt="banner"/>
								</a>
							</td>
						</tr>
					</table>
			)
		}

		function Main2() {
			return (
					<table className="template main2" cellpadding={"0"} cellspacing={"0"} width={"600"} bgcolor={"#FFFFFF"} align={"center"}>
						<tr>
							<td bgcolor="#FFFFFF" align="center" className="greetings">
								<span style={{fontSize: "32px", fontFamily: "Arial, Helvetica, sans-serif;"}}>Hi Emeli,</span>
								<hr />
							</td>
						</tr>
						<tr>
							<td bgcolor="#FFFFFF" align="center" className="thanks">
								<p style={{lineHeight: "150%", fontSize: "18px", fontFamily: "'Times New Roman', Times, serif"}}>Thanks for registering on our site.<br/>Before we get started, we'll need to verify your email.</p>
							</td>
						</tr>
						<tr>
							<td bgcolor="#FFFFFF" class="confirmButton">
								<table className="table-150" bgcolor="#ccad53" cellpadding="0" cellspacing="0" width="200" height="50" align="center">
									<tr>
										<td className="confirm" align="center">
											<span style={{color: "#ffffff", fontSize: "22px", fontFamily: "'Times New Roman', Times, serif"}}>Confirm my email</span>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
			)
		}

		function Footer1() {
			return (
				<table className="template footer1" cellpadding={"0"} cellspacing={"0"} width={"600"} bgcolor={"#FFFFFF"} align={"center"}>
					<tr>
						<td bgcolor="#FFFFFF" align="center">
							<hr bgcolor="#cccccc" width="525"/>
						</td>
					</tr>
					<tr>
						<td align="center" bgcolor="#FFFFFF">
							<img style={{width: "110px", paddingTop: "16px", paddingBottom: "16px"}} src="../img/logo.png" alt="logo"/>
						</td>
					</tr>
					<tr>
						<td align="center" bgcolor="#FFFFFF" className="why">
							<p style={{color: "#666666", fontSize: "13px", fontFamily: "'Times New Roman', Times, serif"}}>You are receiving this email because you have visited our site or asked us about regular newsletter.</p>
						</td>
					</tr>
				</table>
			)
		}
	</script>
	<script type="text/babel">
		const headerNode = document.getElementById("header");
		const header = ReactDOM.createRoot(headerNode);
		const mainNode = document.getElementById("main");
		const main = ReactDOM.createRoot(mainNode);
		const footerNode = document.getElementById("footer");
		const footer = ReactDOM.createRoot(footerNode);

		const choseNode = document.getElementById("choseMenu");
		const chose = ReactDOM.createRoot(choseNode);

		const templatesBlockBuffNode = document.getElementById("templatesBlockBuff");
		const templatesBlock = ReactDOM.createRoot(templatesBlockBuffNode);

		const changeTemplatesBlockNode = document.getElementById("changeTemplatesBlock");
		const changeTemplatesBlock = ReactDOM.createRoot(changeTemplatesBlockNode);

		let letterReact = document.getElementById("letter");
		let removeMode = false;

		let currentHeader;
		let currentMain;
		let currentFooter;
		let currentLoadMenu;

		let headersArray = [<Header1 />, <Header2 />]
		let mainsArray = [<Main1 />, <Main2 />]
		let footersArray = [<Footer1 />]

		function handlerChose(e) {
			let object = e.target;

			if (object.closest('.choseOption')) {
				object = object.closest('.choseOption');

				let numChose = object.classList[1].at(-1);

				if (object.classList.contains("header")) {
					currentHeader.press(numChose - 1);
				}
				else if (object.classList.contains("main")) {
					currentMain.press(numChose - 1);
				}
				else if (object.classList.contains("footer")) {
					currentFooter.press(numChose - 1);
				}
			}
		}

		function ChoseHeader() {
			const listItems = headersArray.map((header, index) =>
					<div className={"choseOption " + "headerMenu" + String(index+1) + " header"}>
						<div className="choseWrapper">
							{header}
						</div>
					</div>
			);

			return (<div onClick={handlerChose}>
				{listItems}
			</div>)
		}

		function ChoseMain() {
			const listItems = mainsArray.map((main, index) =>
					<div className={"choseOption " + "mainMenu" + String(index+1) + " main"}>
						<div className="choseWrapper">
							{main}
						</div>
					</div>
			);

			return (<div onClick={handlerChose}>
				{listItems}
			</div>)
		}

		function ChoseFooter() {
			const listItems = footersArray.map((footer, index) =>
					<div className={"choseOption " + "footerMenu" + String(index+1) + " footer"}>
						<div className="choseWrapper">
							{footer}
						</div>
					</div>
			);

			return (<div onClick={handlerChose}>
				{listItems}
			</div>)
		}

		class CurrentHeader extends React.Component {
			constructor(props) {
				super(props);
				this.press = this.press.bind(this);
				this.state = {content: <Header1 />};
			}
			press(numChose) {
				this.setState({content: headersArray[numChose]});
			}
			deleter() {
				this.setState({content: ""});
			}
			render() {
				currentHeader = this;
				return (
						this.state.content
				);
			}
		}

		class CurrentMain extends React.Component {
			constructor(props) {
				super(props);
				this.press = this.press.bind(this);
				this.state = {content: [<Main1 />, <Main2 />]};
			}
			press(numChose) {
				this.state.content.push(mainsArray[numChose]);
				let buff = this.state.content;
				this.setState({content: buff});
				if (dragTemplateButton.classList.contains("pressed")) {
					changeMoveMode();
				}
				if (removeTemplateButton.classList.contains("pressed")) {
					RemoveTemplateHandler();
				}
			}
			render() {
				currentMain = this;
				return (
					this.state.content
				);
			}
		}

		class CurrentFooter extends React.Component {
			constructor(props) {
				super(props);
				this.press = this.press.bind(this);
				this.state = {content: <Footer1 />};
			}
			press(numChose) {
				this.setState({content: footersArray[numChose]});
			}
			deleter() {
				this.setState({content: ""});
			}
			render() {
				currentFooter = this;
				return (
						this.state.content
				);
			}
		}

		function LoadTemplatesMenuHandler(e) {
			let object = e.target.closest(".typeTemplateBlock");

			if (object.classList.contains("headerTypeTemplateBlock")) {
				currentLoadMenu.press("header")
			}
			else if (object.classList.contains("mainTypeTemplateBlock")) {
				currentLoadMenu.press("main")
			}
			else if (object.classList.contains("footerTypeTemplateBlock")) {
				currentLoadMenu.press("footer")
			}
		}

		function TemplatesBlockComponent() {
			return (
					<div className="typesTemplates" id="typesTemplates">
						<div onClick={LoadTemplatesMenuHandler} className="typeTemplateBlock headerTypeTemplateBlock">
							<img className="TypeTemplateImg" src="../img/headerTemplate.png" alt="" />
						</div>
						<div onClick={LoadTemplatesMenuHandler} className="typeTemplateBlock mainTypeTemplateBlock">
							<img className="TypeTemplateImg" src="../img/mainTemplate.png" alt="" />
						</div>
						<div onClick={LoadTemplatesMenuHandler} className="typeTemplateBlock footerTypeTemplateBlock">
							<img className="TypeTemplateImg" src="../img/footerTemplate.png" alt="" />
						</div>
					</div>
			)
		}

		class LoadTemplatesMenu extends React.Component {
			constructor(props) {
				super(props);
				this.press = this.press.bind(this);
				this.state = {content: <ChoseHeader />};
			}
			press(typeTemplate) {
				if (typeTemplate === "header") {
					this.setState({content: <ChoseHeader />});
				}
				else if (typeTemplate === "main") {
					this.setState({content: <ChoseMain />});
				}
				else if (typeTemplate === "footer") {
					this.setState({content: <ChoseFooter />});
				}
			}
			render() {
				currentLoadMenu = this;
				return (
						this.state.content
				);
			}
		}


		function deleteTemplateOver(e) {
			let object = e.target.closest(".template");
			if (e.relatedTarget) {
				if (object == e.relatedTarget.closest(".template")) {
					return;
				}

				object.style.outline = "4px solid #E74C3C";

				let previousObject = e.relatedTarget.closest(".template");
				if (previousObject) {
					previousObject.style.outline = "";
				}
			}
			else {
				object.style.outline = "4px solid #E74C3C";
			}
		}

		function deleteTemplateOut(e) {
			if (e.relatedTarget) {
				if (e.target.closest(".template") === e.relatedTarget.closest(".template")) {
					return;
				}
				e.target.closest(".template").style.outline = "";
			}
		}

		function moveTemplateOver(e) {
			let object = e.target.closest(".template");

			if (object.parentElement.classList.contains("header") || object.parentElement.classList.contains("footer")
			 	|| object.parentElement.parentElement.classList.contains("header") || object.parentElement.parentElement.classList.contains("footer")) {
				return;
			}

			if (e.relatedTarget) {
				if (object == e.relatedTarget.closest(".template")) {
					return;
				}

				object.style.outline = "4px solid #3498DB";

				let previousObject = e.relatedTarget.closest(".template");
				if (previousObject) {
					previousObject.style.outline = "";
				}
			}
			else {
				object.style.outline = "4px solid #3498DB";
			}
		}

		function moveTemplateOut(e) {
			if (e.relatedTarget) {
				if (e.target.closest(".template") === e.relatedTarget.closest(".template")) {
					return;
				}
				e.target.closest(".template").style.outline = "";
			}
		}

		function handleDeleteClick(e) {
			let object = e.target.closest(".template")
			let parent = object.parentElement;
			let mainTable = document.getElementsByClassName("mainTable")[0];

			if (mainTable.classList.contains("from-storage")) {
				parent.removeChild(object); 
			}
			else {
				if (parent.classList.contains("header")) {
				currentHeader.deleter();
			}
			else if (parent.classList.contains("main")) {
				parent.removeChild(object); 
			}
			else if (parent.classList.contains("footer")) {
				currentFooter.deleter();
			}
			}
		}

		function RemoveTemplateHandler() {
			let removeTemplateButton = document.getElementById("removeTemplateButton");
			let dragTemplateButton = document.getElementById("dragTemplateButton");
			let mainTable = document.getElementsByClassName("mainTable")[0];

			if (removeMode) {
				removeMode = false;
				mainTable.removeEventListener("mouseover", deleteTemplateOver);
				mainTable.removeEventListener("mouseout", deleteTemplateOut);
				removeTemplateButton.classList.remove("pressed");

				letterReact.removeEventListener("click", handleDeleteClick);
			}
			else {
				if (dragTemplateButton.classList.contains("pressed")) {
					changeMoveMode();
				}

				removeMode = true;

				mainTable.addEventListener("mouseover", deleteTemplateOver);
				mainTable.addEventListener("mouseout", deleteTemplateOut);
				removeTemplateButton.classList.add("pressed");

				letterReact.addEventListener("click", handleDeleteClick);
			}
		}

		// drag
		function changeMoveMode() {
			let mainTemplates = document.getElementById("main");
			let dragElements = mainTemplates.querySelectorAll(".template");
			let removeTemplateButton = document.getElementById("removeTemplateButton");
			let dragTemplateButton = document.getElementById("dragTemplateButton");
			let mainTable = document.getElementsByClassName("mainTable")[0];

			if (moveMode) {
				moveMode = false;
				dragTemplateButton.classList.remove("pressed");

				mainTable.removeEventListener("mouseover", moveTemplateOver);
				mainTable.removeEventListener("mouseout", moveTemplateOut);

				for (let i = 0; i < dragElements.length; i++) {
					dragElements[i].draggable = false;
				}

				mainTemplates.removeEventListener(`dragover`, handlerMoveTemplate);
			}
			else {
				if (removeTemplateButton.classList.contains("pressed")) {
					RemoveTemplateHandler();
				}

				moveMode = true;
				dragTemplateButton.classList.add("pressed");
				mainTable.addEventListener("mouseover", moveTemplateOver);
				mainTable.addEventListener("mouseout", moveTemplateOut);

				for (let i = 0; i < dragElements.length; i++) {
					dragElements[i].draggable = true;
				}



				mainTemplates.addEventListener(`dragover`, handlerMoveTemplate);

				mainTemplates.addEventListener(`dragstart`, e => {
					let object = e.target.closest(".template");

					if (object.draggable === true) {
						object.classList.add(`selected`);
					}

				});

				mainTemplates.addEventListener(`dragend`, e => {
					let object = e.target.closest(".template");

					object.classList.remove(`selected`);
				});
			}
		}



		let getNextElement = (cursorPosition, currentElement) => {
			let currentElementCoord = currentElement.getBoundingClientRect();
			let currentElementCenter = currentElementCoord.y + currentElementCoord.height / 2;

			let nextElement = (cursorPosition < currentElementCenter) ?
					currentElement :
					currentElement.nextElementSibling;

			return nextElement;
		};

		function handlerMoveTemplate(e) {
			e.preventDefault();

			let mainTemplates = document.getElementById("main");
			let activeElement = mainTemplates.querySelector(`.selected`);

			if (!activeElement) {
				return;
			}

			let currentElement = e.target.closest(".template");


			let isMoveable = activeElement !== currentElement;
			if (!isMoveable) {
				return;
			}

			let nextElement = getNextElement(e.clientY, currentElement);

			if (!nextElement) {
				nextElement = mainTemplates.lastChild;
				nextElement.after(activeElement);
			}
			else {
				nextElement.before(activeElement);
			}
		}

		// Рендер только если в хранилище не сохранён html текущего письма

        changeTemplatesBlock.render(
            <div className="changeTemplatesBlockWrapper">
                <button onClick={RemoveTemplateHandler} class="removeTemplateButton" id="removeTemplateButton" type="button">Удалить</button>
                <button onClick={changeMoveMode} class="dragTemplateButton" id="dragTemplateButton" type="button">Переместить</button>
            </div>
        );

		if (MyLocalStorage.get_current_letter()['html']) {
            console.log("Upload current letter");

            let mainTable = document.getElementsByClassName("mainTable")[0];
            mainTable.outerHTML = MyLocalStorage.get_current_letter()['html'];
		} else {
            console.log("Upload default letter");
            header.render(
                <CurrentHeader />
            );

            main.render(
                <CurrentMain />
            );

            footer.render(
                <CurrentFooter />
            );

            templatesBlock.render(
                <TemplatesBlockComponent />
            );

            chose.render(
                <LoadTemplatesMenu/>
            );
		}


	</script>
	<script src="../js/app.js"></script>
	<script src="../js/my-script.js"></script>
	<script src="../js/MyLocalStorage.js"></script>
	<script src="../js/redirect.js"></script>
</body>

</html>